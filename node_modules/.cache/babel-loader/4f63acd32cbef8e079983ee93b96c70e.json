{"ast":null,"code":"import _objectSpread from\"/Users/mikey/Desktop/yc-blog/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _slicedToArray from\"/Users/mikey/Desktop/yc-blog/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useState,useEffect}from'react';import styles from\"./style.module.scss\";import{Button,Modal,Select}from\"antd\";import{useDispatch,useSelector}from\"react-redux\";import{getChangePageChildAction,getDelectPageChildAction}from\"../../redux/action\";import{SortableElement}from\"react-sortable-hoc\";import{Banner,List,Footer}from\"./component\";import{cloneDeep}from'lodash';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var Option=Select.Option;var map={Banner:Banner,List:List,Footer:Footer};// 自定义 hooks 把重复的事情 集合起来 schema 传数据 取数据 统一管理\nvar useStore=function useStore(index){var dispatch=useDispatch();var pageChild=useSelector(function(state){var _state$homeManagePage;return((_state$homeManagePage=state.homeManagePageReducer.schema.children)===null||_state$homeManagePage===void 0?void 0:_state$homeManagePage[index])||{};});var changePageChild=function changePageChild(temp){dispatch(getChangePageChildAction(index,temp));};var removePageChild=function removePageChild(){dispatch(getDelectPageChildAction(index));};return{pageChild:pageChild,changePageChild:changePageChild,removePageChild:removePageChild};};export var AreaItem=SortableElement(function(props){// 取父组件数据 就是 AreaList 组件\nvar index=props.value;var _useStore=useStore(index),pageChild=_useStore.pageChild,changePageChild=_useStore.changePageChild,removePageChild=_useStore.removePageChild;// antd ui提供的\nvar _useState=useState(false),_useState2=_slicedToArray(_useState,2),isModalOpen=_useState2[0],setIsModalOpen=_useState2[1];// 控制临时弹窗\nvar _useState3=useState(cloneDeep(pageChild)),_useState4=_slicedToArray(_useState3,2),tempPageChild=_useState4[0],setTempPageChild=_useState4[1];useEffect(function(){setTempPageChild(cloneDeep(pageChild));},[pageChild]);// 展示\nvar showModal=function showModal(){setIsModalOpen(true);};// 确定\nvar handleOkClick=function handleOkClick(){setIsModalOpen(false);changePageChild(tempPageChild);};// 取消\nvar handleModalCancelClick=function handleModalCancelClick(){setIsModalOpen(false);setTempPageChild(cloneDeep(pageChild));};// 改变\nvar handleSelectChange=function handleSelectChange(value){setTempPageChild({name:value,attributes:{},children:[]});};// 给 AdminBanner 提供的方法\nvar changeTempPageChildAttributes=function changeTempPageChildAttributes(kvObj){var newTempPageChild=_objectSpread({},tempPageChild);for(var key in kvObj){newTempPageChild.attributes[key]=kvObj[key];}setTempPageChild(newTempPageChild);};// 给 AdminList 提供的方法\nvar changeTempPageChildChildren=function changeTempPageChildChildren(children){var newTempPageChild=_objectSpread({},tempPageChild);newTempPageChild.children=children;setTempPageChild(newTempPageChild);};//\nvar getComponent=function getComponent(){var name=tempPageChild.name;var Component=map[name];return Component?/*#__PURE__*/_jsx(Component,_objectSpread(_objectSpread({},tempPageChild),{},{changeAttributes:changeTempPageChildAttributes,changeChildren:changeTempPageChildChildren})):null;};return/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsxs(\"li\",{className:styles.item,children:[/*#__PURE__*/_jsx(\"span\",{className:styles.content,onClick:showModal,children:pageChild.name?pageChild.name+'组件':'当前区块内容为空'}),/*#__PURE__*/_jsx(\"span\",{className:styles.delete,children:/*#__PURE__*/_jsx(Button,{size:\"small\",type:\"dashed\",danger:true,onClick:removePageChild,children:\"\\u5220\\u9664\"})}),/*#__PURE__*/_jsxs(Modal,{title:\"\\u9009\\u62E9\\u7EC4\\u4EF6\",open:isModalOpen,onOk:handleOkClick,onCancel:handleModalCancelClick,bodyStyle:{maxHeight:600,overflowY:'scroll'},children:[/*#__PURE__*/_jsxs(Select,{value:tempPageChild.name,className:styles.select,onChange:handleSelectChange,children:[/*#__PURE__*/_jsx(Option,{value:\"Banner\",children:\"Banner \\u7EC4\\u4EF6\"}),/*#__PURE__*/_jsx(Option,{value:\"List\",children:\"List \\u7EC4\\u4EF6\"}),/*#__PURE__*/_jsx(Option,{value:\"Footer\",children:\"Footer \\u7EC4\\u4EF6\"})]}),getComponent()]})]})});});","map":{"version":3,"names":["React","useState","useEffect","styles","Button","Modal","Select","useDispatch","useSelector","getChangePageChildAction","getDelectPageChildAction","SortableElement","Banner","List","Footer","cloneDeep","Option","map","useStore","index","dispatch","pageChild","state","homeManagePageReducer","schema","children","changePageChild","temp","removePageChild","AreaItem","props","value","isModalOpen","setIsModalOpen","tempPageChild","setTempPageChild","showModal","handleOkClick","handleModalCancelClick","handleSelectChange","name","attributes","changeTempPageChildAttributes","kvObj","newTempPageChild","key","changeTempPageChildChildren","getComponent","Component","item","content","delete","maxHeight","overflowY","select"],"sources":["/Users/mikey/Desktop/yc-blog/src/admin/components/areaItem/AreaItem.jsx"],"sourcesContent":["import React, {useState,useEffect} from 'react';\nimport styles from \"./style.module.scss\";\nimport {Button, Modal, Select} from \"antd\";\nimport {useDispatch, useSelector} from \"react-redux\";\nimport {getChangePageChildAction, getDelectPageChildAction} from \"../../redux/action\";\nimport {SortableElement} from \"react-sortable-hoc\";\nimport {Banner, List,Footer} from \"./component\";\nimport {cloneDeep} from 'lodash';\n\nconst {Option} = Select;\nconst map = {Banner, List, Footer};\n\n// 自定义 hooks 把重复的事情 集合起来 schema 传数据 取数据 统一管理\nconst useStore = (index) => {\n    const dispatch = useDispatch();\n    const pageChild = useSelector((state) => state.homeManagePageReducer.schema.children?.[index] || {});\n    const changePageChild = (temp) => {\n        dispatch(getChangePageChildAction(index, temp));\n    };\n    const removePageChild = () => {\n        dispatch(getDelectPageChildAction(index));\n    };\n    return {pageChild, changePageChild, removePageChild};\n}\n\nexport const AreaItem = SortableElement((props) => {\n    // 取父组件数据 就是 AreaList 组件\n    const {value:index} = props;\n    const {pageChild, changePageChild, removePageChild} = useStore(index);\n    // antd ui提供的\n    const [isModalOpen, setIsModalOpen] = useState(false);\n    // 控制临时弹窗\n    const [tempPageChild, setTempPageChild] = useState(cloneDeep(pageChild));\n\n    useEffect(() => {\n        setTempPageChild(cloneDeep(pageChild));\n    },[pageChild])\n\n    // 展示\n    const showModal = () => {\n        setIsModalOpen(true);\n    };\n\n    // 确定\n    const handleOkClick = () => {\n        setIsModalOpen(false);\n        changePageChild(tempPageChild);\n    };\n\n    // 取消\n    const handleModalCancelClick = () => {\n        setIsModalOpen(false);\n        setTempPageChild(cloneDeep(pageChild));\n    };\n\n    // 改变\n    const handleSelectChange = (value) => {\n        setTempPageChild({name: value, attributes: {}, children: []});\n    }\n\n    // 给 AdminBanner 提供的方法\n    const changeTempPageChildAttributes = (kvObj) => {\n        const newTempPageChild = {...tempPageChild};\n        for (let key in kvObj) {\n            newTempPageChild.attributes[key] = kvObj[key];\n        }\n        setTempPageChild(newTempPageChild);\n    }\n    // 给 AdminList 提供的方法\n    const changeTempPageChildChildren = (children) => {\n        const newTempPageChild = {...tempPageChild};\n            newTempPageChild.children= children;\n        setTempPageChild(newTempPageChild);\n    }\n    //\n    const getComponent = () => {\n        const {name} = tempPageChild;\n        const Component = map[name];\n        return Component ? (<Component {...tempPageChild} changeAttributes ={changeTempPageChildAttributes}\n                       changeChildren={changeTempPageChildChildren}/>) : null;\n    }\n    return (\n        <div>\n            <li className={styles.item}>\n                <span className={styles.content} onClick={showModal}>\n                    {pageChild.name ? pageChild.name + '组件' : '当前区块内容为空'}</span>\n                <span className={styles.delete}>\n                    <Button size='small' type='dashed' danger onClick={removePageChild}>删除</Button>\n                </span>\n                <Modal title=\"选择组件\" open={isModalOpen} onOk={handleOkClick}\n                       onCancel={handleModalCancelClick} bodyStyle={{maxHeight:600,overflowY:'scroll'}}>\n                    <Select value={tempPageChild.name} className={styles.select}\n                            onChange={handleSelectChange}>\n                        <Option value='Banner'>Banner 组件</Option>\n                        <Option value='List'>List 组件</Option>\n                        <Option value='Footer'>Footer 组件</Option>\n                    </Select>\n                    {getComponent()}\n                </Modal>\n            </li>\n        </div>\n    )\n})"],"mappings":"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"},"metadata":{},"sourceType":"module"}