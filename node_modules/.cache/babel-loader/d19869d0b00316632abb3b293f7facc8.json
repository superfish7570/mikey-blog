{"ast":null,"code":"var __awaiter = this && this.__awaiter || function (thisArg, _arguments, P, generator) {\n  function adopt(value) {\n    return value instanceof P ? value : new P(function (resolve) {\n      resolve(value);\n    });\n  }\n\n  return new (P || (P = Promise))(function (resolve, reject) {\n    function fulfilled(value) {\n      try {\n        step(generator.next(value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n\n    function rejected(value) {\n      try {\n        step(generator[\"throw\"](value));\n      } catch (e) {\n        reject(e);\n      }\n    }\n\n    function step(result) {\n      result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected);\n    }\n\n    step((generator = generator.apply(thisArg, _arguments || [])).next());\n  });\n};\n\nvar __generator = this && this.__generator || function (thisArg, body) {\n  var _ = {\n    label: 0,\n    sent: function sent() {\n      if (t[0] & 1) throw t[1];\n      return t[1];\n    },\n    trys: [],\n    ops: []\n  },\n      f,\n      y,\n      t,\n      g;\n  return g = {\n    next: verb(0),\n    \"throw\": verb(1),\n    \"return\": verb(2)\n  }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function () {\n    return this;\n  }), g;\n\n  function verb(n) {\n    return function (v) {\n      return step([n, v]);\n    };\n  }\n\n  function step(op) {\n    if (f) throw new TypeError(\"Generator is already executing.\");\n\n    while (_) {\n      try {\n        if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n        if (y = 0, t) op = [op[0] & 2, t.value];\n\n        switch (op[0]) {\n          case 0:\n          case 1:\n            t = op;\n            break;\n\n          case 4:\n            _.label++;\n            return {\n              value: op[1],\n              done: false\n            };\n\n          case 5:\n            _.label++;\n            y = op[1];\n            op = [0];\n            continue;\n\n          case 7:\n            op = _.ops.pop();\n\n            _.trys.pop();\n\n            continue;\n\n          default:\n            if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) {\n              _ = 0;\n              continue;\n            }\n\n            if (op[0] === 3 && (!t || op[1] > t[0] && op[1] < t[3])) {\n              _.label = op[1];\n              break;\n            }\n\n            if (op[0] === 6 && _.label < t[1]) {\n              _.label = t[1];\n              t = op;\n              break;\n            }\n\n            if (t && _.label < t[2]) {\n              _.label = t[2];\n\n              _.ops.push(op);\n\n              break;\n            }\n\n            if (t[2]) _.ops.pop();\n\n            _.trys.pop();\n\n            continue;\n        }\n\n        op = body.call(thisArg, _);\n      } catch (e) {\n        op = [6, e];\n        y = 0;\n      } finally {\n        f = t = 0;\n      }\n    }\n\n    if (op[0] & 5) throw op[1];\n    return {\n      value: op[0] ? op[1] : void 0,\n      done: true\n    };\n  }\n};\n\nimport { UdfDataType } from '../types/graphql.v2';\nimport { JSEncrypt } from './jsencrypt/jsencrypt';\nimport { doEncrypt } from './sm-crypto/sm2/index';\nexport var encrypt = function encrypt(plainText, publicKey, encryption) {\n  return __awaiter(void 0, void 0, void 0, function () {\n    return __generator(this, function (_a) {\n      return [2\n      /*return*/\n      , new Promise(function (resolve, reject) {\n        // 国密支持，动态引入\n        if (encryption && (encryption === null || encryption === void 0 ? void 0 : encryption.type) === 'sm2') {\n          if (!encryption.publicKey) {\n            throw new Error('未配置: encryption.publicKey');\n          }\n\n          var encrypted_1 = doEncrypt(plainText, encryption.publicKey);\n          return resolve(\"sm2:\" + encrypted_1);\n        }\n\n        var jsencrypt = new JSEncrypt({});\n        jsencrypt.setPublicKey(publicKey); // 设置公钥\n\n        var encrypted = jsencrypt.encrypt(plainText);\n\n        if (encrypted !== false) {\n          resolve(encrypted);\n        } else {\n          reject(encrypted);\n        }\n      })];\n    });\n  });\n};\nexport default function buildTree(nodes) {\n  /* nodes structure\n  [\n    {\"id\": \"1\", \"children\": [\"2\"], \"root\": true},\n    {\"id\": \"2\", \"children\": [\"3\", \"4\"], \"root\": false},\n    {\"id\": \"3\", \"children\": [], \"root\": false},\n    {\"id\": \"4\", \"children\": [], \"root\": false},\n  ]\n     转换成 ->\n  {\n    id: 1,\n    children: [\n      {\n        id: 2,\n        children: [\n          {\n            id: 3,\n            children: []\n          },\n          {\n            id: 4,\n            children: []\n          }\n        ]\n      }\n    ]\n  }\n  */\n  var rootNodes = [nodes.find(function (x) {\n    return x.root === true;\n  })];\n\n  var mapChildren = function mapChildren(childId) {\n    var node = nodes.find(function (x) {\n      return x.id === childId;\n    }) || null;\n\n    if (Array.isArray(node.children) && node.children.length > 0) {\n      node.children = node.children.map(mapChildren).filter(function (node) {\n        return node !== null;\n      });\n    }\n\n    return node;\n  };\n\n  var tree = rootNodes.map(function (node) {\n    node.children = node.children.map(mapChildren).filter(function (node) {\n      return node !== null;\n    });\n    return node;\n  });\n  return tree[0];\n}\nexport var deepEqual = function deepEqual(x, y) {\n  if (x === y) {\n    return true;\n  } else if (typeof x == 'object' && x != null && typeof y == 'object' && y != null) {\n    if (Object.keys(x).length != Object.keys(y).length) return false;\n\n    for (var prop in x) {\n      if (y.hasOwnProperty(prop)) {\n        if (!deepEqual(x[prop], y[prop])) return false;\n      } else return false;\n    }\n\n    return true;\n  } else return false;\n};\nexport var popupCenter = function popupCenter(url, _a) {\n  var _b = _a === void 0 ? {\n    w: 585,\n    h: 649\n  } : _a,\n      w = _b.w,\n      h = _b.h; // Fixes dual-screen position                             Most browsers      Firefox\n\n\n  var dualScreenLeft = window.screenLeft !== undefined ? window.screenLeft : window.screenX;\n  var dualScreenTop = window.screenTop !== undefined ? window.screenTop : window.screenY;\n  var width = window.innerWidth ? window.innerWidth : document.documentElement.clientWidth ? document.documentElement.clientWidth : window.screen.width;\n  var height = window.innerHeight ? window.innerHeight : document.documentElement.clientHeight ? document.documentElement.clientHeight : window.screen.height;\n  var systemZoom = width / window.screen.availWidth;\n  var left = (width - w) / 2 / systemZoom + dualScreenLeft;\n  var top = (height - h) / 2 / systemZoom + dualScreenTop;\n  var newWindow = window.open(url, '_blank', \"\\n      toolbar=no,\\n      menubar=no,\\n      scrollbars=no,\\n      resizable=no,\\n      location=no,\\n      status=no\\n      width=\" + w / systemZoom + \",\\n      height=\" + h / systemZoom + \",\\n      top=\" + top + \",\\n      left=\" + left + \"\\n      \");\n  newWindow === null || newWindow === void 0 ? void 0 : newWindow.focus();\n  return newWindow;\n};\nexport var createCssClassStyleSheet = function createCssClassStyleSheet(className, styleSheet) {\n  var styleTag = document.createElement('style');\n  var styleText = \"\\n    .\" + className + \" {\\n      \" + styleSheet + \"\\n    }\\n  \";\n  var textNode = document.createTextNode(styleText);\n  styleTag.appendChild(textNode);\n  document.head.appendChild(styleTag);\n};\nexport var serialize = function serialize(obj) {\n  var str = [];\n\n  for (var p in obj) {\n    if (obj.hasOwnProperty(p)) {\n      if (obj[p] !== undefined) {\n        str.push(encodeURIComponent(p) + '=' + encodeURIComponent(obj[p]));\n      }\n    }\n  }\n\n  return str.join('&');\n};\nexport var convertUdv = function convertUdv(data) {\n  for (var _i = 0, data_1 = data; _i < data_1.length; _i++) {\n    var item = data_1[_i];\n    var dataType = item.dataType,\n        value = item.value;\n\n    if (dataType === UdfDataType.Number) {\n      item.value = JSON.parse(value);\n    } else if (dataType === UdfDataType.Boolean) {\n      item.value = JSON.parse(value);\n    } else if (dataType === UdfDataType.Datetime) {\n      item.value = new Date(parseInt(value));\n    } else if (dataType === UdfDataType.Object) {\n      item.value = JSON.parse(value);\n    }\n  }\n\n  return data;\n};\n\nvar isNumeric = function isNumeric(str) {\n  if (typeof str != 'string') return false; // we only process strings!\n\n  return (// @ts-ignore\n    !isNaN(str) && !isNaN(parseFloat(str)) // use type coercion to parse the _entirety_ of the string (`parseFloat` alone does not do this)...\n\n  ); // ...and ensure strings of whitespace fail\n};\n\nexport var convertUdvToKeyValuePair = function convertUdvToKeyValuePair(data) {\n  data = data || [];\n\n  for (var _i = 0, data_2 = data; _i < data_2.length; _i++) {\n    var item = data_2[_i];\n    var dataType = item.dataType,\n        value = item.value;\n\n    if (dataType === UdfDataType.Number) {\n      item.value = JSON.parse(value);\n    } else if (dataType === UdfDataType.Boolean) {\n      item.value = JSON.parse(value);\n    } else if (dataType === UdfDataType.Datetime) {\n      item.value = isNumeric(value) ? new Date(parseInt(value)) : new Date(value);\n    } else if (dataType === UdfDataType.Object) {\n      item.value = JSON.parse(value);\n    }\n  }\n\n  var ret = {};\n\n  for (var _a = 0, data_3 = data; _a < data_3.length; _a++) {\n    var item = data_3[_a];\n    ret[item.key] = item.value;\n  }\n\n  return ret;\n};\nexport var isWechatBrowser = function isWechatBrowser() {\n  return typeof navigator !== 'undefined' && /MicroMessenger/i.test(navigator === null || navigator === void 0 ? void 0 : navigator.userAgent);\n};\nexport var isLarkBrowser = function isLarkBrowser() {\n  return typeof navigator !== 'undefined' && /Lark/i.test(navigator.userAgent);\n};\nexport var isMobileBrowser = function isMobileBrowser() {\n  return isWechatBrowser() || isLarkBrowser();\n};\nexport var formatAuthorizedResources = function formatAuthorizedResources(resources) {\n  return resources.map(function (resource) {\n    for (var key in resource) {\n      if (!resource[key]) {\n        delete resource[key];\n      }\n    }\n\n    return resource;\n  });\n};\nexport function generateUidKey(number) {\n  var map = [];\n\n  for (var i = 97; i < 123; i++) {\n    map.push(String.fromCharCode(i));\n  }\n\n  var arr = [];\n\n  while (number--) {\n    var rand = Math.floor(Math.random() * 16);\n    arr.push(map[rand]);\n  }\n\n  return arr.join('');\n}\nexport var xhrUpload = function xhrUpload(file, url) {\n  return new Promise(function (resolve, reject) {\n    var formData = new FormData();\n    formData.append('file', file, file instanceof Blob ? 'personal.jpeg' : undefined);\n    var xhr = new XMLHttpRequest();\n\n    xhr.onreadystatechange = function () {\n      // 上传成功\n      if (this.readyState === 4) {\n        try {\n          var res = JSON.parse(this.responseText);\n          var code = res.code,\n              message = res.message,\n              data = res.data;\n\n          if (code !== 200) {\n            reject({\n              code: code,\n              message: message\n            });\n          }\n\n          resolve(data);\n        } catch (error) {\n          var code = 500;\n          var message = \"\\u4E0A\\u4F20\\u56FE\\u7247\\u5931\\u8D25, error = \" + error.message;\n          reject({\n            code: code,\n            message: message\n          });\n        }\n      }\n    };\n\n    xhr.open('POST', url);\n    xhr.send(formData);\n  });\n};\nexport function uploadFile(opts) {\n  var url = opts.url,\n      accept = opts.accept,\n      multiple = opts.multiple;\n  return new Promise(function (resolve, reject) {\n    var inputElem = document.createElement('input');\n    inputElem.type = 'file';\n    inputElem.accept = accept;\n    inputElem.multiple = multiple;\n\n    inputElem.onchange = function () {\n      var files = inputElem.files;\n\n      if (!multiple) {\n        var file = files[0];\n        xhrUpload(file, url).then(function (res) {\n          return resolve(res);\n        }).catch(function (error) {\n          return reject(error);\n        });\n      } else {\n        var promises = [];\n        var i = 0;\n\n        while (i < files.length) {\n          promises.push(xhrUpload(files[i], url));\n          i++;\n        }\n\n        Promise.all(promises).then(function (res) {\n          return resolve(res);\n        }).catch(function (error) {\n          return reject(error);\n        });\n      }\n    };\n\n    inputElem.click();\n  });\n}\nexport var convertKeyValueListToObject = function convertKeyValueListToObject(data) {\n  var ret = {};\n\n  for (var _i = 0, data_4 = data; _i < data_4.length; _i++) {\n    var _a = data_4[_i],\n        key = _a.key,\n        value = _a.value;\n    ret[key] = value;\n  }\n\n  return ret;\n};\nexport var convertObjectToKeyValueList = function convertObjectToKeyValueList(data) {\n  var ret = [];\n\n  for (var _i = 0, _a = Object.keys(data); _i < _a.length; _i++) {\n    var key = _a[_i];\n    ret.push({\n      key: key,\n      value: data[key]\n    });\n  }\n\n  return ret;\n};\nexport function generateRandomString(length) {\n  if (length === void 0) {\n    length = 30;\n  }\n\n  var result = '';\n  var characters = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789';\n  var charactersLength = characters.length;\n\n  for (var i = 0; i < length; i++) {\n    result += characters.charAt(Math.floor(Math.random() * charactersLength));\n  }\n\n  return result;\n}\nexport var pickBy = function pickBy(obj, predicate) {\n  var ret = {};\n\n  for (var _i = 0, _a = Object.keys(obj); _i < _a.length; _i++) {\n    var key = _a[_i];\n\n    if (predicate(obj[key], key)) {\n      ret[key] = obj[key];\n    }\n  }\n\n  return ret;\n};","map":{"version":3,"sources":["../../../src/lib/utils.ts"],"names":[],"mappings":"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","sourceRoot":"","sourcesContent":["var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __generator = (this && this.__generator) || function (thisArg, body) {\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n    function verb(n) { return function (v) { return step([n, v]); }; }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (_) try {\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [op[0] & 2, t.value];\n            switch (op[0]) {\n                case 0: case 1: t = op; break;\n                case 4: _.label++; return { value: op[1], done: false };\n                case 5: _.label++; y = op[1]; op = [0]; continue;\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop(); continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\nimport { UdfDataType } from '../types/graphql.v2';\nimport { JSEncrypt } from './jsencrypt/jsencrypt';\nimport { doEncrypt } from './sm-crypto/sm2/index';\nexport var encrypt = function (plainText, publicKey, encryption) { return __awaiter(void 0, void 0, void 0, function () {\n    return __generator(this, function (_a) {\n        return [2 /*return*/, new Promise(function (resolve, reject) {\n                // 国密支持，动态引入\n                if (encryption && (encryption === null || encryption === void 0 ? void 0 : encryption.type) === 'sm2') {\n                    if (!encryption.publicKey) {\n                        throw new Error('未配置: encryption.publicKey');\n                    }\n                    var encrypted_1 = doEncrypt(plainText, encryption.publicKey);\n                    return resolve(\"sm2:\" + encrypted_1);\n                }\n                var jsencrypt = new JSEncrypt({});\n                jsencrypt.setPublicKey(publicKey); // 设置公钥\n                var encrypted = jsencrypt.encrypt(plainText);\n                if (encrypted !== false) {\n                    resolve(encrypted);\n                }\n                else {\n                    reject(encrypted);\n                }\n            })];\n    });\n}); };\nexport default function buildTree(nodes) {\n    /* nodes structure\n    [\n      {\"id\": \"1\", \"children\": [\"2\"], \"root\": true},\n      {\"id\": \"2\", \"children\": [\"3\", \"4\"], \"root\": false},\n      {\"id\": \"3\", \"children\": [], \"root\": false},\n      {\"id\": \"4\", \"children\": [], \"root\": false},\n    ]\n  \n    转换成 ->\n    {\n      id: 1,\n      children: [\n        {\n          id: 2,\n          children: [\n            {\n              id: 3,\n              children: []\n            },\n            {\n              id: 4,\n              children: []\n            }\n          ]\n        }\n      ]\n    }\n    */\n    var rootNodes = [nodes.find(function (x) { return x.root === true; })];\n    var mapChildren = function (childId) {\n        var node = nodes.find(function (x) { return x.id === childId; }) || null;\n        if (Array.isArray(node.children) && node.children.length > 0) {\n            node.children = node.children\n                .map(mapChildren)\n                .filter(function (node) { return node !== null; });\n        }\n        return node;\n    };\n    var tree = rootNodes.map(function (node) {\n        node.children = node.children\n            .map(mapChildren)\n            .filter(function (node) { return node !== null; });\n        return node;\n    });\n    return tree[0];\n}\nexport var deepEqual = function (x, y) {\n    if (x === y) {\n        return true;\n    }\n    else if (typeof x == 'object' &&\n        x != null &&\n        typeof y == 'object' &&\n        y != null) {\n        if (Object.keys(x).length != Object.keys(y).length)\n            return false;\n        for (var prop in x) {\n            if (y.hasOwnProperty(prop)) {\n                if (!deepEqual(x[prop], y[prop]))\n                    return false;\n            }\n            else\n                return false;\n        }\n        return true;\n    }\n    else\n        return false;\n};\nexport var popupCenter = function (url, _a) {\n    var _b = _a === void 0 ? { w: 585, h: 649 } : _a, w = _b.w, h = _b.h;\n    // Fixes dual-screen position                             Most browsers      Firefox\n    var dualScreenLeft = window.screenLeft !== undefined ? window.screenLeft : window.screenX;\n    var dualScreenTop = window.screenTop !== undefined ? window.screenTop : window.screenY;\n    var width = window.innerWidth\n        ? window.innerWidth\n        : document.documentElement.clientWidth\n            ? document.documentElement.clientWidth\n            : window.screen.width;\n    var height = window.innerHeight\n        ? window.innerHeight\n        : document.documentElement.clientHeight\n            ? document.documentElement.clientHeight\n            : window.screen.height;\n    var systemZoom = width / window.screen.availWidth;\n    var left = (width - w) / 2 / systemZoom + dualScreenLeft;\n    var top = (height - h) / 2 / systemZoom + dualScreenTop;\n    var newWindow = window.open(url, '_blank', \"\\n      toolbar=no,\\n      menubar=no,\\n      scrollbars=no,\\n      resizable=no,\\n      location=no,\\n      status=no\\n      width=\" + w / systemZoom + \",\\n      height=\" + h / systemZoom + \",\\n      top=\" + top + \",\\n      left=\" + left + \"\\n      \");\n    newWindow === null || newWindow === void 0 ? void 0 : newWindow.focus();\n    return newWindow;\n};\nexport var createCssClassStyleSheet = function (className, styleSheet) {\n    var styleTag = document.createElement('style');\n    var styleText = \"\\n    .\" + className + \" {\\n      \" + styleSheet + \"\\n    }\\n  \";\n    var textNode = document.createTextNode(styleText);\n    styleTag.appendChild(textNode);\n    document.head.appendChild(styleTag);\n};\nexport var serialize = function (obj) {\n    var str = [];\n    for (var p in obj)\n        if (obj.hasOwnProperty(p)) {\n            if (obj[p] !== undefined) {\n                str.push(encodeURIComponent(p) + '=' + encodeURIComponent(obj[p]));\n            }\n        }\n    return str.join('&');\n};\nexport var convertUdv = function (data) {\n    for (var _i = 0, data_1 = data; _i < data_1.length; _i++) {\n        var item = data_1[_i];\n        var dataType = item.dataType, value = item.value;\n        if (dataType === UdfDataType.Number) {\n            item.value = JSON.parse(value);\n        }\n        else if (dataType === UdfDataType.Boolean) {\n            item.value = JSON.parse(value);\n        }\n        else if (dataType === UdfDataType.Datetime) {\n            item.value = new Date(parseInt(value));\n        }\n        else if (dataType === UdfDataType.Object) {\n            item.value = JSON.parse(value);\n        }\n    }\n    return data;\n};\nvar isNumeric = function (str) {\n    if (typeof str != 'string')\n        return false; // we only process strings!\n    return (\n    // @ts-ignore\n    !isNaN(str) && !isNaN(parseFloat(str)) // use type coercion to parse the _entirety_ of the string (`parseFloat` alone does not do this)...\n    ); // ...and ensure strings of whitespace fail\n};\nexport var convertUdvToKeyValuePair = function (data) {\n    data = data || [];\n    for (var _i = 0, data_2 = data; _i < data_2.length; _i++) {\n        var item = data_2[_i];\n        var dataType = item.dataType, value = item.value;\n        if (dataType === UdfDataType.Number) {\n            item.value = JSON.parse(value);\n        }\n        else if (dataType === UdfDataType.Boolean) {\n            item.value = JSON.parse(value);\n        }\n        else if (dataType === UdfDataType.Datetime) {\n            item.value = isNumeric(value)\n                ? new Date(parseInt(value))\n                : new Date(value);\n        }\n        else if (dataType === UdfDataType.Object) {\n            item.value = JSON.parse(value);\n        }\n    }\n    var ret = {};\n    for (var _a = 0, data_3 = data; _a < data_3.length; _a++) {\n        var item = data_3[_a];\n        ret[item.key] = item.value;\n    }\n    return ret;\n};\nexport var isWechatBrowser = function () {\n    return typeof navigator !== 'undefined' &&\n        /MicroMessenger/i.test(navigator === null || navigator === void 0 ? void 0 : navigator.userAgent);\n};\nexport var isLarkBrowser = function () {\n    return typeof navigator !== 'undefined' && /Lark/i.test(navigator.userAgent);\n};\nexport var isMobileBrowser = function () {\n    return isWechatBrowser() || isLarkBrowser();\n};\nexport var formatAuthorizedResources = function (resources) {\n    return resources.map(function (resource) {\n        for (var key in resource) {\n            if (!resource[key]) {\n                delete resource[key];\n            }\n        }\n        return resource;\n    });\n};\nexport function generateUidKey(number) {\n    var map = [];\n    for (var i = 97; i < 123; i++) {\n        map.push(String.fromCharCode(i));\n    }\n    var arr = [];\n    while (number--) {\n        var rand = Math.floor(Math.random() * 16);\n        arr.push(map[rand]);\n    }\n    return arr.join('');\n}\nexport var xhrUpload = function (file, url) {\n    return new Promise(function (resolve, reject) {\n        var formData = new FormData();\n        formData.append('file', file, file instanceof Blob ? 'personal.jpeg' : undefined);\n        var xhr = new XMLHttpRequest();\n        xhr.onreadystatechange = function () {\n            // 上传成功\n            if (this.readyState === 4) {\n                try {\n                    var res = JSON.parse(this.responseText);\n                    var code = res.code, message = res.message, data = res.data;\n                    if (code !== 200) {\n                        reject({\n                            code: code,\n                            message: message\n                        });\n                    }\n                    resolve(data);\n                }\n                catch (error) {\n                    var code = 500;\n                    var message = \"\\u4E0A\\u4F20\\u56FE\\u7247\\u5931\\u8D25, error = \" + error.message;\n                    reject({\n                        code: code,\n                        message: message\n                    });\n                }\n            }\n        };\n        xhr.open('POST', url);\n        xhr.send(formData);\n    });\n};\nexport function uploadFile(opts) {\n    var url = opts.url, accept = opts.accept, multiple = opts.multiple;\n    return new Promise(function (resolve, reject) {\n        var inputElem = document.createElement('input');\n        inputElem.type = 'file';\n        inputElem.accept = accept;\n        inputElem.multiple = multiple;\n        inputElem.onchange = function () {\n            var files = inputElem.files;\n            if (!multiple) {\n                var file = files[0];\n                xhrUpload(file, url)\n                    .then(function (res) { return resolve(res); })\n                    .catch(function (error) { return reject(error); });\n            }\n            else {\n                var promises = [];\n                var i = 0;\n                while (i < files.length) {\n                    promises.push(xhrUpload(files[i], url));\n                    i++;\n                }\n                Promise.all(promises)\n                    .then(function (res) { return resolve(res); })\n                    .catch(function (error) { return reject(error); });\n            }\n        };\n        inputElem.click();\n    });\n}\nexport var convertKeyValueListToObject = function (data) {\n    var ret = {};\n    for (var _i = 0, data_4 = data; _i < data_4.length; _i++) {\n        var _a = data_4[_i], key = _a.key, value = _a.value;\n        ret[key] = value;\n    }\n    return ret;\n};\nexport var convertObjectToKeyValueList = function (data) {\n    var ret = [];\n    for (var _i = 0, _a = Object.keys(data); _i < _a.length; _i++) {\n        var key = _a[_i];\n        ret.push({\n            key: key,\n            value: data[key]\n        });\n    }\n    return ret;\n};\nexport function generateRandomString(length) {\n    if (length === void 0) { length = 30; }\n    var result = '';\n    var characters = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789';\n    var charactersLength = characters.length;\n    for (var i = 0; i < length; i++) {\n        result += characters.charAt(Math.floor(Math.random() * charactersLength));\n    }\n    return result;\n}\nexport var pickBy = function (obj, predicate) {\n    var ret = {};\n    for (var _i = 0, _a = Object.keys(obj); _i < _a.length; _i++) {\n        var key = _a[_i];\n        if (predicate(obj[key], key)) {\n            ret[key] = obj[key];\n        }\n    }\n    return ret;\n};\n//# sourceMappingURL=utils.js.map"]},"metadata":{},"sourceType":"module"}